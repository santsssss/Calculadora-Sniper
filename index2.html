<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Trading - NERD do CS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
        .small-icon {
            width: 14px;
            height: 14px;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-amber-50 to-green-50 min-h-screen p-6">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-2xl shadow-lg p-6 border-2 border-amber-400">
            <!-- Header -->
            <div class="flex flex-col items-center mb-6">
                <img 
                    src="https://github.com/user-attachments/assets/30e1f5e3-8849-44f6-ab84-f3197f3f1485" 
                    alt="NERD do CS" 
                    class="w-24 h-24 mb-3"
                />
                <h1 class="text-2xl font-bold text-amber-600">Calculadora de Trading</h1>
            </div>

            <!-- Mode Selector -->
            <div class="flex gap-4 mb-6 justify-center">
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="radio" name="mode" value="back-lay" checked class="w-5 h-5" style="accent-color: #d97706;" onchange="changeMode('back-lay')">
                    <span class="font-medium text-slate-700">Back/Lay</span>
                </label>
                <label class="flex items-center gap-2 cursor-pointer">
                    <input type="radio" name="mode" value="lay-back" class="w-5 h-5" style="accent-color: #d97706;" onchange="changeMode('lay-back')">
                    <span class="font-medium text-slate-700">Lay/Back</span>
                </label>
            </div>

            <!-- Toggle para mÃºltiplos -->
            <div class="flex justify-center mb-6">
                <button id="toggleMultiplos" onclick="toggleMode()" 
                    class="px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 bg-amber-100 text-amber-700 hover:bg-amber-200">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><rect x="9" y="9" width="3" height="3"/><path d="M9 1v6m0 4v6m-6-6h6m4 0h6"/></svg>
                    <span id="toggleText">MÃºltiplos Placares</span>
                </button>
            </div>

            <!-- Modo Simples -->
            <div id="modoSimples" class="max-w-md mx-auto">
                <!-- Back/Lay Mode -->
                <div id="backLayMode" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Odd Back</label>
                        <input type="number" step="0.01" id="oddBack" placeholder="2" 
                            class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
                            oninput="calculateBackLay()">
                        <p class="text-xs text-slate-500 mt-1">Preencha com o odd de entrada em back</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Stake Back</label>
                        <input type="number" step="0.01" id="stakeBack" placeholder="100"
                            class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
                            oninput="calculateBackLay()">
                        <p class="text-xs text-slate-500 mt-1">Preencha com a stake de entrada do back</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Odd Lay</label>
                        <input type="number" step="0.01" id="oddLay" placeholder="4"
                            class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
                            oninput="calculateBackLay()">
                        <p class="text-xs text-slate-500 mt-1">Preencha com o odd de saÃ­da em lay</p>
                    </div>

                    <!-- Resultado Back/Lay -->
                    <div id="resultBackLay"></div>

                    <!-- PrÃ©via Back/Lay -->
                    <div id="previewBackLay"></div>
                </div>

                <!-- Lay/Back Mode -->
                <div id="layBackMode" class="space-y-4" style="display: none;">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Odd Lay</label>
                        <input type="number" step="0.01" id="oddLayEntry" placeholder="10"
                            class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
                            oninput="calculateLayBack()">
                        <p class="text-xs text-slate-500 mt-1">Preencha com o odd de entrada em lay</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Responsabilidade Lay</label>
                        <input type="number" step="0.01" id="responsabilidade" placeholder="100"
                            class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
                            oninput="calculateLayBack()">
                        <p class="text-xs text-slate-500 mt-1">Preencha com a responsabilidade de entrada do lay</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Odd Back</label>
                        <input type="number" step="0.01" id="oddBackExit" placeholder="20"
                            class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500"
                            oninput="calculateLayBack()">
                        <p class="text-xs text-slate-500 mt-1">Preencha com o odd de saÃ­da em back</p>
                    </div>

                    <!-- Resultado Lay/Back -->
                    <div id="resultLayBack"></div>

                    <!-- PrÃ©via Lay/Back -->
                    <div id="previewLayBack"></div>
                </div>
            </div>

            <!-- Modo MÃºltiplos -->
            <div id="modoMultiplos" class="space-y-4" style="display: none;">
                <div class="bg-blue-50 border border-blue-300 rounded-lg p-3">
                    <h3 class="font-medium text-blue-800 text-sm">
                        ðŸ“‹ MÃºltiplos Placares - <span id="modeLabel">Back/Lay</span>
                    </h3>
                </div>

                <!-- Header da tabela -->
                <div class="bg-amber-50 rounded-lg p-2 border border-amber-300">
                    <div class="grid grid-cols-8 gap-2 text-xs font-medium text-amber-800">
                        <div class="text-center">Placar</div>
                        <div class="text-center">Resp.</div>
                        <div class="text-center">Odd In</div>
                        <div class="text-center">Odd Out</div>
                        <div class="text-center">Lucro</div>
                        <div class="text-center">%</div>
                        <div class="text-center">Stake</div>
                        <div class="text-center">-</div>
                    </div>
                </div>

                <!-- Container dos mÃºltiplos -->
                <div id="multiplosContainer" class="space-y-2">
                    <!-- Linhas serÃ£o adicionadas via JS -->
                </div>

                <!-- BotÃµes e Resumo -->
                <div class="flex flex-col gap-3">
                    <!-- BotÃµes de aÃ§Ã£o -->
                    <div class="flex justify-center gap-3">
                        <button onclick="addMultiplo()" 
                            class="inline-flex items-center gap-1 px-3 py-1 bg-amber-600 hover:bg-amber-700 text-white rounded text-sm transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                            Adicionar
                        </button>
                        
                        <button id="clearAllBtn" onclick="clearAllMultiplos()" style="display: none;"
                            class="inline-flex items-center gap-1 px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm transition-colors"
                            title="Limpar todos os placares">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3,6 5,6 21,6"></polyline><path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0,0,1 -2,-2V6m3,0V4a2,2 0,0,1 2,-2h4a2,2 0,0,1 2,2v2"></path></svg>
                            Limpar Tudo
                        </button>
                    </div>

                    <!-- Resumo -->
                    <div id="resumoMultiplos"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // SVG Icons
        const copyIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>';
        const checkIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>';
        const copyIconSmall = '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>';
        const checkIconSmall = '<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>';

        let copiedTimeout = null;
        let currentMode = 'back-lay';
        let showMultiplos = false;
        let multiplos = [{ id: 1, placar: '', responsabilidade: '', oddIn: '', oddOut: '' }];
        let nextId = 2;

        // FunÃ§Ã£o para arredondar odds para valores vÃ¡lidos da exchange
        function roundToValidOdd(odd) {
            if (odd <= 2.0) return Math.round(odd * 100) / 100;
            if (odd <= 3.0) return Math.round(odd * 50) / 50;
            if (odd <= 4.0) return Math.round(odd * 20) / 20;
            if (odd <= 6.0) return Math.round(odd * 10) / 10;
            if (odd <= 10.0) return Math.round(odd * 5) / 5;
            if (odd <= 20.0) return Math.round(odd * 2) / 2;
            if (odd <= 30) return Math.round(odd);
            if (odd <= 50) return Math.round(odd / 2) * 2;
            if (odd <= 100) return Math.round(odd / 5) * 5;
            return Math.round(odd / 10) * 10;
        }

        // Toggle entre modo simples e mÃºltiplos
        function toggleMode() {
            showMultiplos = !showMultiplos;
            const toggleBtn = document.getElementById('toggleMultiplos');
            const toggleText = document.getElementById('toggleText');
            const modoSimples = document.getElementById('modoSimples');
            const modoMultiplos = document.getElementById('modoMultiplos');

            if (showMultiplos) {
                toggleBtn.className = 'px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 bg-amber-600 text-white hover:bg-amber-700';
                toggleText.textContent = 'Modo Simples';
                modoSimples.style.display = 'none';
                modoMultiplos.style.display = 'block';
                renderMultiplos();
            } else {
                toggleBtn.className = 'px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 bg-amber-100 text-amber-700 hover:bg-amber-200';
                toggleText.textContent = 'MÃºltiplos Placares';
                modoSimples.style.display = 'block';
                modoMultiplos.style.display = 'none';
            }
        }

        // Mudar modo de cÃ¡lculo
        function changeMode(mode) {
            currentMode = mode;
            document.getElementById('modeLabel').textContent = mode === 'back-lay' ? 'Back/Lay' : 'Lay/Back';
            
            if (mode === 'back-lay') {
                document.getElementById('backLayMode').style.display = 'block';
                document.getElementById('layBackMode').style.display = 'none';
            } else {
                document.getElementById('backLayMode').style.display = 'none';
                document.getElementById('layBackMode').style.display = 'block';
            }
            
            if (showMultiplos) {
                renderMultiplos();
            }
        }

        // Copiar para clipboard
        function copyToClipboard(value, buttonId) {
            navigator.clipboard.writeText(value).then(() => {
                const button = document.getElementById(buttonId);
                if (button) {
                    const originalHTML = button.innerHTML;
                    button.innerHTML = button.classList.contains('small-icon') ? checkIconSmall : checkIcon;
                    button.classList.add('text-green-600');
                    
                    if (copiedTimeout) clearTimeout(copiedTimeout);
                    copiedTimeout = setTimeout(() => {
                        button.innerHTML = originalHTML;
                        button.classList.remove('text-green-600');
                    }, 2000);
                }
            });
        }

        // Calcular mÃºltiplo individual
        function calculateMultiplo(item) {
            const resp = parseFloat(item.responsabilidade) || 0;
            const oddIn = parseFloat(item.oddIn) || 0;
            const oddOut = parseFloat(item.oddOut) || 0;
            
            if (resp === 0 || oddIn === 0 || oddOut === 0) {
                return { lucro: 0, percentual: 0, stakeSaida: 0 };
            }

            if (currentMode === 'back-lay') {
                const stakeLay = (resp * oddIn) / oddOut;
                const lucro = stakeLay - resp;
                const percentual = (lucro / resp) * 100;
                return {
                    lucro: lucro.toFixed(2),
                    percentual: percentual.toFixed(2),
                    stakeSaida: stakeLay.toFixed(2)
                };
            } else {
                const stakeBack = (resp * oddIn) / ((oddIn - 1) * oddOut);
                const stakeLay = resp / (oddIn - 1);
                const lucro = stakeLay - stakeBack;
                const percentual = (lucro / resp) * 100;
                return {
                    lucro: lucro.toFixed(2),
                    percentual: percentual.toFixed(2),
                    stakeSaida: stakeBack.toFixed(2)
                };
            }
        }

        // Atualizar mÃºltiplo
        function updateMultiplo(id, field, value) {
            const index = multiplos.findIndex(item => item.id === id);
            if (index !== -1) {
                multiplos[index][field] = value;
                renderMultiplos();
            }
        }

        // Adicionar mÃºltiplo
        function addMultiplo() {
            multiplos.push({
                id: nextId++,
                placar: '',
                responsabilidade: '',
                oddIn: '',
                oddOut: ''
            });
            renderMultiplos();
        }

        // Remover mÃºltiplo
        function removeMultiplo(id) {
            if (multiplos.length > 1) {
                multiplos = multiplos.filter(item => item.id !== id);
                renderMultiplos();
            }
        }

        // Limpar todos os mÃºltiplos
        function clearAllMultiplos() {
            multiplos = [{ id: 1, placar: '', responsabilidade: '', oddIn: '', oddOut: '' }];
            nextId = 2;
            renderMultiplos();
        }

        // Calcular totais
        function getTotaisMultiplos() {
            let totalResponsabilidade = 0;
            let totalLucro = 0;
            let totalStake = 0;
            let lucroMaximo = 0;

            multiplos.forEach(item => {
                const resp = parseFloat(item.responsabilidade) || 0;
                const oddIn = parseFloat(item.oddIn) || 0;
                const calculated = calculateMultiplo(item);
                
                totalResponsabilidade += resp;
                totalLucro += parseFloat(calculated.lucro) || 0;
                totalStake += parseFloat(calculated.stakeSaida) || 0;

                // Calcular lucro mÃ¡ximo
                if (resp > 0 && oddIn > 0) {
                    if (currentMode === 'back-lay') {
                        const ganhoBack = (oddIn - 1) * resp;
                        lucroMaximo += ganhoBack;
                    } else {
                        const stakeLay = resp / (oddIn - 1);
                        lucroMaximo += stakeLay;
                    }
                }
            });

            return {
                totalResponsabilidade: totalResponsabilidade.toFixed(2),
                totalLucro: totalLucro.toFixed(2),
                totalStake: totalStake.toFixed(2),
                percentualGeral: totalResponsabilidade > 0 ? ((totalLucro / totalResponsabilidade) * 100).toFixed(2) : '0.00',
                lucroMaximo: lucroMaximo.toFixed(2),
                percentualMaximo: totalResponsabilidade > 0 ? ((lucroMaximo / totalResponsabilidade) * 100).toFixed(2) : '0.00'
            };
        }

        // Renderizar mÃºltiplos
        function renderMultiplos() {
            const container = document.getElementById('multiplosContainer');
            const totais = getTotaisMultiplos();
            
            container.innerHTML = '';
            
            multiplos.forEach((item, index) => {
                const calculated = calculateMultiplo(item);
                const div = document.createElement('div');
                div.className = 'bg-white border border-slate-200 rounded-lg p-2 hover:bg-slate-50 transition-colors';
                
                div.innerHTML = `
                    <div class="grid grid-cols-8 gap-2 items-center">
                        <div>
                            <input type="text" value="${item.placar}" placeholder="2x1"
                                class="w-full px-2 py-1 text-sm text-center border border-slate-300 rounded focus:ring-1 focus:ring-amber-500 focus:border-amber-500"
                                onchange="updateMultiplo(${item.id}, 'placar', this.value)">
                        </div>
                        <div>
                            <input type="number" step="0.01" value="${item.responsabilidade}" placeholder="100"
                                class="w-full px-2 py-1 text-sm text-center border border-slate-300 rounded focus:ring-1 focus:ring-amber-500 focus:border-amber-500"
                                onchange="updateMultiplo(${item.id}, 'responsabilidade', this.value)">
                        </div>
                        <div>
                            <input type="number" step="0.01" value="${item.oddIn}" placeholder="2.5"
                                class="w-full px-2 py-1 text-sm text-center border border-slate-300 rounded focus:ring-1 focus:ring-amber-500 focus:border-amber-500"
                                onchange="updateMultiplo(${item.id}, 'oddIn', this.value)">
                        </div>
                        <div>
                            <input type="number" step="0.01" value="${item.oddOut}" placeholder="3.5"
                                class="w-full px-2 py-1 text-sm text-center border border-slate-300 rounded focus:ring-1 focus:ring-amber-500 focus:border-amber-500"
                                onchange="updateMultiplo(${item.id}, 'oddOut', this.value)">
                        </div>
                        <div class="text-center">
                            <span class="text-sm font-medium ${parseFloat(calculated.lucro) >= 0 ? 'text-green-600' : 'text-red-600'}">
                                ${calculated.lucro}
                            </span>
                        </div>
                        <div class="text-center">
                            <span class="text-xs ${parseFloat(calculated.percentual) >= 0 ? 'text-green-600' : 'text-red-600'}">
                                ${calculated.percentual}%
                            </span>
                        </div>
                        <div class="flex items-center gap-1">
                            <span class="text-sm font-medium text-slate-700 flex-1 text-center">
                                ${calculated.stakeSaida}
                            </span>
                            <button id="copyBtn${item.id}" onclick="copyToClipboard('${calculated.stakeSaida}', 'copyBtn${item.id}')"
                                class="p-1 hover:bg-amber-100 rounded transition-colors small-icon inline-flex items-center justify-center"
                                title="Copiar">${copyIconSmall}</button>
                        </div>
                        <div class="text-center">
                            ${multiplos.length > 1 ? `
                                <button onclick="removeMultiplo(${item.id})"
                                    class="p-1 text-red-600 hover:bg-red-100 rounded transition-colors"
                                    title="Remover">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3,6 5,6 21,6"></polyline><path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0,0,1 -2,-2V6m3,0V4a2,2 0,0,1 2,-2h4a2,2 0,0,1 2,2v2"></path></svg>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
                
                container.appendChild(div);
            });

            // Mostrar/ocultar botÃ£o limpar tudo
            const clearBtn = document.getElementById('clearAllBtn');
            clearBtn.style.display = multiplos.length > 1 ? 'block' : 'none';

            // Renderizar resumo
            renderResumo(totais);
        }

        // Renderizar resumo
        function renderResumo(totais) {
            const resumoContainer = document.getElementById('resumoMultiplos');
            const hasData = multiplos.some(item => item.responsabilidade && item.oddIn) || multiplos.length > 1;
            
            if (!hasData) {
                resumoContainer.innerHTML = '';
                return;
            }

            let resumoHTML = '';
            
            // Primeiro bloco - Resumo atual
            resumoHTML += '<div class="bg-green-50 border border-green-300 rounded-lg p-3">';
            resumoHTML += '<p class="text-xs text-green-700 text-center mb-2 font-medium">ðŸ“Š Resumo com Odds de SaÃ­da</p>';
            resumoHTML += '<div class="grid grid-cols-4 gap-3 text-center">';
            
            resumoHTML += '<div><p class="text-xs text-green-700">Total Resp.</p>';
            resumoHTML += '<p class="text-sm font-bold text-slate-800">' + totais.totalResponsabilidade + '</p></div>';
            
            resumoHTML += '<div><p class="text-xs text-green-700">Total Stake</p>';
            resumoHTML += '<div class="flex items-center justify-center gap-1">';
            resumoHTML += '<span class="text-sm font-bold text-slate-800">' + totais.totalStake + '</span>';
            resumoHTML += '<button id="copyTotalStake" onclick="copyToClipboard(\'' + totais.totalStake + '\', \'copyTotalStake\')" class="p-0.5 hover:bg-green-200 rounded transition-colors small-icon inline-flex items-center justify-center">' + copyIconSmall + '</button>';
            resumoHTML += '</div></div>';
            
            const lucroColor = parseFloat(totais.totalLucro) >= 0 ? 'text-green-600' : 'text-red-600';
            resumoHTML += '<div><p class="text-xs text-green-700">Lucro Atual</p>';
            resumoHTML += '<p class="text-sm font-bold ' + lucroColor + '">' + totais.totalLucro + '</p></div>';
            
            const percentColor = parseFloat(totais.percentualGeral) >= 0 ? 'text-green-600' : 'text-red-600';
            resumoHTML += '<div><p class="text-xs text-green-700">% Atual</p>';
            resumoHTML += '<p class="text-sm font-bold ' + percentColor + '">' + totais.percentualGeral + '%</p></div>';
            
            resumoHTML += '</div></div>';

            // Segundo bloco - Lucro mÃ¡ximo (se aplicÃ¡vel)
            if (parseFloat(totais.lucroMaximo) > 0) {
                resumoHTML += '<div class="bg-blue-50 border border-blue-300 rounded-lg p-3 mt-3">';
                resumoHTML += '<p class="text-xs text-blue-700 text-center mb-2 font-medium">ðŸŽ¯ Lucro MÃ¡ximo (se TODAS ganharem)</p>';
                resumoHTML += '<div class="grid grid-cols-3 gap-3 text-center">';
                
                resumoHTML += '<div><p class="text-xs text-blue-700">Lucro MÃ¡ximo</p>';
                resumoHTML += '<p class="text-lg font-bold text-blue-600">+' + totais.lucroMaximo + '</p></div>';
                
                resumoHTML += '<div><p class="text-xs text-blue-700">% MÃ¡ximo</p>';
                resumoHTML += '<p class="text-lg font-bold text-blue-600">+' + totais.percentualMaximo + '%</p></div>';
                
                const retornoTotal = (parseFloat(totais.totalResponsabilidade) + parseFloat(totais.lucroMaximo)).toFixed(2);
                resumoHTML += '<div><p class="text-xs text-blue-700">Retorno Total</p>';
                resumoHTML += '<p class="text-sm font-bold text-slate-800">' + retornoTotal + '</p></div>';
                
                resumoHTML += '</div></div>';
            }

            resumoContainer.innerHTML = resumoHTML;
        }

        // Calcular Back/Lay
        function calculateBackLay() {
            const ob = parseFloat(document.getElementById('oddBack').value);
            const sb = parseFloat(document.getElementById('stakeBack').value);
            const ol = parseFloat(document.getElementById('oddLay').value);

            // Calcular resultado final primeiro
            if (!isNaN(ob) && !isNaN(sb) && !isNaN(ol)) {
                const stakeLay = (sb * ob) / ol;
                const lucro = stakeLay - sb;
                const percentual = (lucro / sb) * 100;
                const lucroColor = lucro >= 0 ? 'text-green-600' : 'text-red-600';

                document.getElementById('resultBackLay').innerHTML = `
                    <div class="mt-6 p-4 bg-green-50 rounded-lg border-2 border-green-300">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-semibold text-green-700">Stake de Lay</span>
                            <div class="flex items-center gap-2">
                                <span class="text-lg font-bold text-slate-800">${stakeLay.toFixed(2)}</span>
                                <button id="copyBtnFinalBackLay" onclick="copyToClipboard('${stakeLay.toFixed(2)}', 'copyBtnFinalBackLay')"
                                    class="p-1 hover:bg-green-200 rounded transition-colors text-slate-600 inline-flex items-center justify-center"
                                    title="Copiar stake">${copyIcon}</button>
                            </div>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-semibold text-slate-600">Perda/Lucro</span>
                            <span class="text-lg font-bold ${lucroColor}">${lucro.toFixed(2)} (${percentual.toFixed(2)} %)</span>
                        </div>
                    </div>
                `;
            } else {
                document.getElementById('resultBackLay').innerHTML = '';
            }

            // Calcular prÃ©via
            if (!isNaN(ob) && !isNaN(sb)) {
                const ganhoMaximo = (ob - 1) * sb;
                const lucros = [
                    { label: 'MÃ¡ximo (100%)', valor: ganhoMaximo },
                    { label: '50%', valor: ganhoMaximo * 0.5 },
                    { label: '30%', valor: ganhoMaximo * 0.3 }
                ];

                let previewHTML = '<div class="bg-amber-50 border border-amber-300 rounded-lg p-3"><h3 class="font-medium text-amber-800 mb-2 text-xs">ðŸ“Š PrÃ©via para nÃ­veis de saÃ­da</h3><div class="space-y-1.5">';
                
                lucros.forEach((item, idx) => {
                    const oddLaySugerida = (sb * ob) / (sb + item.valor);
                    const oddLayArredondada = roundToValidOdd(oddLaySugerida);
                    const stakeLay = (sb * ob) / oddLayArredondada;
                    const lucroReal = stakeLay - sb;
                    const percentual = ((lucroReal / sb) * 100).toFixed(2);

                    previewHTML += `
                        <div class="bg-white rounded p-2 flex justify-between items-center text-xs border border-amber-200">
                            <div class="flex-1">
                                <p class="font-medium text-slate-800">${item.label}</p>
                                <p class="text-green-600">+${lucroReal.toFixed(2)} (+${percentual}%)</p>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="text-right">
                                    <button onclick="document.getElementById('oddLay').value='${oddLayArredondada.toFixed(2)}'; calculateBackLay();"
                                        class="bg-amber-600 hover:bg-amber-700 text-white px-2 py-1 rounded font-medium transition-colors text-xs">
                                        Odd ${oddLayArredondada.toFixed(2)}
                                    </button>
                                    <div class="flex items-center gap-1 mt-1 justify-end">
                                        <span class="text-slate-600">Stake: ${stakeLay.toFixed(2)}</span>
                                        <button id="copyBtnPreview${idx}" onclick="copyToClipboard('${stakeLay.toFixed(2)}', 'copyBtnPreview${idx}')"
                                            class="p-0.5 hover:bg-amber-100 rounded transition-colors text-slate-600 small-icon inline-flex items-center justify-center"
                                            title="Copiar stake">${copyIconSmall}</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                previewHTML += '</div></div>';
                document.getElementById('previewBackLay').innerHTML = previewHTML;
            } else {
                document.getElementById('previewBackLay').innerHTML = '';
            }
        }

        // Calcular Lay/Back
        function calculateLayBack() {
            const ol = parseFloat(document.getElementById('oddLayEntry').value);
            const resp = parseFloat(document.getElementById('responsabilidade').value);
            const ob = parseFloat(document.getElementById('oddBackExit').value);

            // Calcular resultado final primeiro
            if (!isNaN(ol) && !isNaN(resp) && !isNaN(ob)) {
                const stakeBack = (resp * ol) / ((ol - 1) * ob);
                const stakeLay = resp / (ol - 1);
                const lucro = stakeLay - stakeBack;
                const percentual = (lucro / resp) * 100;
                const lucroColor = lucro >= 0 ? 'text-green-600' : 'text-red-600';

                document.getElementById('resultLayBack').innerHTML = `
                    <div class="mt-6 p-4 bg-green-50 rounded-lg border-2 border-green-300">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-semibold text-green-700">Stake de Back</span>
                            <div class="flex items-center gap-2">
                                <span class="text-lg font-bold text-slate-800">${stakeBack.toFixed(2)}</span>
                                <button id="copyBtnFinalLayBack" onclick="copyToClipboard('${stakeBack.toFixed(2)}', 'copyBtnFinalLayBack')"
                                    class="p-1 hover:bg-green-200 rounded transition-colors text-slate-600 inline-flex items-center justify-center"
                                    title="Copiar stake">${copyIcon}</button>
                            </div>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-semibold text-slate-600">Perda/Lucro</span>
                            <span class="text-lg font-bold ${lucroColor}">${lucro.toFixed(2)} (${percentual.toFixed(2)} %)</span>
                        </div>
                    </div>
                `;
            } else {
                document.getElementById('resultLayBack').innerHTML = '';
            }

            // Calcular prÃ©via
            if (!isNaN(ol) && !isNaN(resp)) {
                const ganhoMaximo = resp / (ol - 1);
                const lucros = [
                    { label: 'MÃ¡ximo (100%)', valor: ganhoMaximo },
                    { label: '50%', valor: ganhoMaximo * 0.5 },
                    { label: '30%', valor: ganhoMaximo * 0.3 }
                ];

                let previewHTML = '<div class="bg-amber-50 border border-amber-300 rounded-lg p-3"><h3 class="font-medium text-amber-800 mb-2 text-xs">ðŸ“Š PrÃ©via para nÃ­veis de saÃ­da</h3><div class="space-y-1.5">';
                
                lucros.forEach((item, idx) => {
                    const stakeLay = resp / (ol - 1);
                    const stakeBackNecessaria = stakeLay - item.valor;
                    const oddBackSugerida = (resp * ol) / ((ol - 1) * stakeBackNecessaria);
                    const oddBackArredondada = roundToValidOdd(oddBackSugerida);
                    const stakeBackReal = (resp * ol) / ((ol - 1) * oddBackArredondada);
                    const lucroReal = stakeLay - stakeBackReal;
                    const percentual = ((lucroReal / resp) * 100).toFixed(2);

                    previewHTML += `
                        <div class="bg-white rounded p-2 flex justify-between items-center text-xs border border-amber-200">
                            <div class="flex-1">
                                <p class="font-medium text-slate-800">${item.label}</p>
                                <p class="text-green-600">+${lucroReal.toFixed(2)} (+${percentual}%)</p>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="text-right">
                                    <button onclick="document.getElementById('oddBackExit').value='${oddBackArredondada.toFixed(2)}'; calculateLayBack();"
                                        class="bg-amber-600 hover:bg-amber-700 text-white px-2 py-1 rounded font-medium transition-colors text-xs">
                                        Odd ${oddBackArredondada.toFixed(2)}
                                    </button>
                                    <div class="flex items-center gap-1 mt-1 justify-end">
                                        <span class="text-slate-600">Stake: ${stakeBackReal.toFixed(2)}</span>
                                        <button id="copyBtnPreviewLB${idx}" onclick="copyToClipboard('${stakeBackReal.toFixed(2)}', 'copyBtnPreviewLB${idx}')"
                                            class="p-0.5 hover:bg-amber-100 rounded transition-colors text-slate-600 small-icon inline-flex items-center justify-center"
                                            title="Copiar stake">${copyIconSmall}</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                previewHTML += '</div></div>';
                document.getElementById('previewLayBack').innerHTML = previewHTML;
            } else {
                document.getElementById('previewLayBack').innerHTML = '';
            }
        }

        // Inicializar mÃºltiplos
        window.onload = function() {
            renderMultiplos();
        };
    </script>
</body>
</html>
